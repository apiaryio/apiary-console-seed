machine:
  node:
    version: 7.2.0

  hosts:
    api.xyz.com: 127.0.0.1
    console.apiary.dev: 127.0.0.1

checkout:
  post:
    - echo 'NODE_ENV=CI' > .env && cd server && npm install

dependencies:
  cache_directories:
    - "server/node_modules"

test:
  pre:
    - npm run build:extension
    - cd server && npm start:
        background: true
    - npm start:
        background: true

deployment:
  production:
    branch: master
    commands:
      - npm run semantic-release || true
